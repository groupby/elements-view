<!DOCTYPE html>
<html>
  <head>
    <title>M.King Apparel</title>
    <link href="https://fonts.googleapis.com/css?family=Lato|Montserrat:400,700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/b47cfcd035.js"></script>
    <script src="../dist/components.js"></script>
    <script src="./temp/sfx-all-plugins-bundle.js"></script>
    <link rel="stylesheet" href="client.css">
  </head>
  <body>
    <header>
      <div class="wrapper">
        <div class="logo">
          <i class="fas fa-crown"></i>
        </div>
        <nav class="header-nav">
          <ul>
            <li><a class="scroll" href="#home">Home</a></li>
            <li><a class="scroll" href="#new-arrivals">New Arrivals</a></li>
            <li><a class="scroll" href="#catalogue">Catalogue</a></li>
            <li><a class="scroll" href="#about">About</a></li>
            <li><a class="scroll" href="#contact">Contact</a></li>
          </ul>
        </nav>
        <div class="sfx-header-search-controls">
          <sfx-search-box id="header-searchbox" placeholder="Search"></sfx-search-box>
          <button id="header-clear-button" class="clear"><i class="fas fa-times"></i></button>
          <button id="header-submit-button" class="submit"><i class="fas fa-search"></i></button>
          <sfx-sayt searchbox="header-searchbox" tabindex="1"></sfx-sayt>
        </div>
      </div>
    </header>

    <section class="hero">
      <div class="wrapper">
        <h1>M. King <span>Apparel</span></h1>
        <a class="scroll" href="#catalogue">Shop Now</a>
      </div>
    </section>

    <main>
      <div class="wrapper">
        <section id="new-arrivals" class="new-arrivals">
          <h2>New Arrivals</h2>
          <div class="new-arrivals-sections">
            <div class="new-arrivals-section new-arrivals-men">
              <img src="./assets/mens-clothing.jpg" alt="A set of men's clothing.">
            </div>
            <div class="new-arrivals-section new-arrivals-women">
              <img src="./assets/womens-clothing.jpg" alt="A set of women's clothing.">
            </div>
            <div class="new-arrivals-section new-arrivals-more">
              <img src="./assets/more-clothing.jpg" alt="A coat hanger on an orange background.">
            </div>
          </div>
        </section>
      </div>

      <section id="catalogue" class="catalogue">
        <div class="wrapper">
          <h2>Our Catalogue</h2>
          <div class="sfx-catalogue-search-controls">
            <sfx-search-box id="catalogue-searchbox" placeholder="Search"></sfx-search-box>
            <button id="catalogue-clear-button" class="clear"><i class="fas fa-times"></i></button>
            <button id="catalogue-submit-button" class="submit"><i class="fas fa-search"></i></button>
            <sfx-sayt searchbox="catalogue-searchbox" hideproducts></sfx-sayt>
          </div>
          <div class="catalogue-product-grid">
            <sfx-products></sfx-products>
          </div>
        </div>
      </section>
    </main>
    <script>
      // init core and plugins
      const core = new sfxCore.Core();
      const domEventsPlugin = new sfxPlugins.DomEventsPlugin()
      const saytPlugin = new sfxPlugins.SaytPlugin({subdomain: 'apparel', collection: 'products'});
      const saytDriverPlugin = new sfxPlugins.SaytDriverPlugin();
      const searchPlugin = new sfxPlugins.SearchPlugin({ customerId: 'apparel', collection: 'products', area: 'Storefront'});
      const searchDriverPlugin = new sfxPlugins.SearchDriverPlugin();
      // register all plugins with core
      core.register([saytPlugin, saytDriverPlugin, domEventsPlugin, searchPlugin, searchDriverPlugin]);
      // search integration/functionality test

      // Clear button functionality
      const headerClearButtonNode = document.getElementById('header-clear-button');
      headerClearButtonNode.addEventListener('click', (e) => {
        const headerSearchBoxNode = document.getElementById('header-searchbox');

        headerSearchBoxNode.clearSearch();
      });

      const catalogueClearButtonNode = document.getElementById('catalogue-clear-button');
      catalogueClearButtonNode.addEventListener('click', (e) => {
        const catalogueSearchBoxNode = document.getElementById('catalogue-searchbox');

        catalogueSearchBoxNode.clearSearch();
      });

      // Catalogue submit button functionality
      const catalogueSubmitButtonNode = document.getElementById('catalogue-submit-button');
      catalogueSubmitButtonNode.addEventListener('click', (e) => {
        const catalogueProductGridNode = document.getElementsByClassName('catalogue-product-grid')[0];

        catalogueProductGridNode.classList.add('catalogue-product-grid-visible');
      });

    </script>
    <!-- Smooth Scroll Code is Below -->
    <script>
      // Vanilla JavaScript Scroll to Anchor
        // @ https://perishablepress.com/vanilla-javascript-scroll-anchor/

        (function () {
          scrollTo();
        })();

        function scrollTo() {
          const links = document.querySelectorAll('.scroll');
          links.forEach(each => (each.onclick = scrollAnchors));
        }

        function scrollAnchors(e, respond = null) {
          const distanceToTop = el => Math.floor(el.getBoundingClientRect().top);
          e.preventDefault();
          let targetID = (respond) ? respond.getAttribute('href') : this.getAttribute('href');
          const targetAnchor = document.querySelector(targetID);
          if (!targetAnchor) return;
          const originalTop = distanceToTop(targetAnchor);
          window.scrollBy({ top: originalTop, left: 0, behavior: 'smooth' });
          const checkIfDone = setInterval(function () {
            const atBottom = window.innerHeight + window.pageYOffset >= document.body.offsetHeight - 2;
            if (distanceToTop(targetAnchor) === 0 || atBottom) {
              targetAnchor.tabIndex = '-1';
              window.history.pushState('', '', targetID);
              clearInterval(checkIfDone);
            }
          }, 100);
        }
    </script>
  </body>
</html>
